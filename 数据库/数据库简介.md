# 第一章 引言

## 数据库系统概述、目标及发展历史

### DBMS定义

- 由一个相互关联的数据集合和一组用以访问这些数据的程序组成

- 这个数据集合通常称作数据库，其中包括了关于某个机构的信息

### DBMS目标

方便、高效地存取数据库信息

![1](\图片\1.png)

### 1.数据库系统的应用

- 企业管理
- 银行金融
- 大学：学生、课程等管理
- 航空公司：预定，日程表
- 电信：通话管理、账单管理

### 2，数据库系统的目标

- 四个基本概念

  - **数据：数据库中存储的基本对象**

    - 数据的定义：描述事物的符号记录

    - 数据的种类：文字、图形、图像、声音

    - 数据的特点：数据与其语义是不可分的

    - 数据结构：逻辑结构 数据之间存在的逻辑关系

      ​                                    表、树、图、数组...

      ​                   物理结构 数据在计算机内存储方式

      ​                                    顺序方式、链接方式...

      

  ![2](\图片\2.png)

  

  - **数据库**：

    - 关系数据库二维表举例

    ![3](\图片\3.png)

    - 人们收集并抽取出一个应用所需要的大量数据后，应将其保存起来以供进一步加工处理，进一步抽取有用的信息
    - **数据库定义：数据库是长期储存在计算机内、有组织、可共享的大量数据集合**
    - **数据库的特征：**
      - 数据按一定的数据模型组织、描述和储存
      - 可为各种用户共享
      - 冗余度较小
      - 数据独立性较高
      - 易扩展

  - **数据库管理系统**：
    - 什么是DBMS
      - 数据库管理系统 是由一个相互关联的数据的集合和一组用以访问这些数据的程序组成
      - 是位于用户和操作系统之间的一层数据管理软件
      
    - DBMS的用途
      - 科学地组织和存储数据、高效的获取和维护数据
      
    - **DBMS的主要功能**
      
      - 数据定义功能
        
        ​    提供数据定义语言(DDL)
        ​    定义数据库中的数据对象
        
      - 数据操纵功能
                   提供数据操纵语言(DML)
                   操纵数据实现对数据库的基本操作  (查询、插入、删除和修改)
               
      - 数据库的运行管理
            	保证数据的安全性、完整性
            	保证多用户对数据的并发使用
                发生故障后的系统恢复
      
      - 数据库的建立和维护功能
                数据库数据批量装载
                数据库转储
                介质故障恢复
                数据库的重组织
                性能监视

  - **数据库系统**：

    - 什么是数据库系统：数据库系统是指在计算机系统中引入数据库后的系统

    ​                                          在不引起混淆的情况下常常把数据库系统简称为数据库

    - 数据库系统的构成：由数据库、数据库管理系统、应用系统（及其开发工具）、数据库管理员（和用户）构成

      ![4](.\图片\4.png)

      ![5](.\图片\5.png)

- 数据管理技术的发展

  - 什么是数据管理：对数据进行分类、组织、编码、存储、检索和维护，是数据处理的中心问题

  - 数据管理技术的发展动力

    1. 应用需求的推动
    2. 计算机硬件的发展
    3. 计算机软件的发展

  - 数据管理的发展阶段

    - 人工管理阶段（50年代中期以前）

    ![6](.\图片\6.png)

    - 文件系统阶段（50年代后期---60年代中期）

      - 使用文件系统来存储数据的缺点

        - 在早期，数据库应用程序直接建立在文件系统之上，文件系统的弊端在于

          1. **数据的冗余和不一致性**

             多种文件格式, 相同的信息在几个文件重复存储

          2. **数据访问困难**

             对于每一个新任务，需要写一个新程序

          3. **数据孤立**：数据分散在不同格式的多个文件中

          4. **完整性问题**
             一致性约束(account balance > 0) “淹没” 在程序代码中
             增加新约束或修改现有约束都很困难

          5. **更新的原子性问题**
             难以保持原子性，执行部分更新，使得数据处于不一致状态
             如: 转帐，要么完成，要么不做

          6. **多用户的并发访问异常**
             系统的总体性能和响应速度要求：并发访问数据
             没有控制的并发访问导致不一致性
             如:两人读取一个账户

          7. **安全性问题**
             控制用户只存取部分数据，难以实现

    ![7](.\图片\7.png)

    ![8](.\图片\8.png)

    - 数据库系统阶段（60年代后期开始）

      - 数据库观点：数据不是依赖于处理过程的附属品，而是现实世界中独立存在的对象

        ![9](C:\Users\Dell\Desktop\MarkDown学习\面向对象\图片\9.png)

      - 特点：

        1. 有了数据库管理系统，由DBMS统一存取，维护数据语义及结构
        2. 面向全组织，面向现实世界
        3. 独立性较强

      - 数据库系统 vs 文件系统

        - 数据的冗余和不一致
        - 数据访问困难
        - 数据孤立
        - 完整性问题
        - 原子性问题
        - 并发访问异常
        - 安全性问题![10](C:\Users\Dell\Desktop\MarkDown学习\面向对象\图片\10.png)

- 数据库系统的目标

## 数据视图

数据库系统的一个主要目的是给用户提供数据的抽象视图，即隐藏关于数据存储和维护的某种细节

### 3.1实例与模式

- **型与值的区别**

  型是对数据的结构和属性的说明----模式

  值是型的一个具体赋值        ----实例

  型是相对稳定的，值是随时间不断变化的

- 模式–数据库的总体设计

  - 物理模式：在物理层描述的数据库设计
  - 逻辑模式：在逻辑层描述的数据库设计
  - 子模式/外模式：在视图层描述的数据库设计，逻辑模式的子集
  
- 实例–特定时刻存储在数据库中的信息的集合
  - 所有二维表的实例的集合
  
- 物理数据独立性 –物理模式的改变而不会影响逻辑模式

  - 当物理模式改变时，修改模式/内模式映象，使外模式保持不变，从而应用程序可以保持不变，称为数据的物理独立性
  
- 逻辑数据独立性
  
    - 当模式改变时，修改外模式/模式映象，使外模式保持不变，从而应用程序可以保持不变，称为数据的逻辑独立性

![11](C:\Users\Dell\Desktop\MarkDown学习\面向对象\图片\11.png)


### 3.2数据抽象

- 物理层:描述数据存储
- 逻辑层:描述数据库中的数据以及数据之间的关系，即数据的定义
- 视图层:最高层次的抽象，只描述整个数据库的某部分数据
  - 视图层提供了防止用户访问数据库的某些部分的安全性机制

### 3.3数据模型

- 数据模型是数据库结构的基础
- 数据模型描述内容
  - 数据
  - 数据关系
  - 数据语义
  - 数据约束
- 常用数据模型
    - 关系模型
    - 实体-联系数据模型(主要用于数据库设计) 
    - 基于对象的数据模型(面向对象和对象关系)
    - 半结构化数据模型(XML)
    - 其他模型
        - 网状模型
        - 层次模型


## 数据模型

- **关系模型**

  关系模型中的表格数据实例

  ![12](C:\Users\Dell\Desktop\MarkDown学习\面向对象\图片\12.png)

- **E-R数据模型**

![13](C:\Users\Dell\Desktop\MarkDown学习\面向对象\图片\13.png)

- **OO数据模型**

![14](C:\Users\Dell\Desktop\MarkDown学习\面向对象\图片\14.png)

- **层次模型**

![15](C:\Users\Dell\Desktop\MarkDown学习\面向对象\图片\15.png)

- **网状模型**

![16](C:\Users\Dell\Desktop\MarkDown学习\面向对象\图片\16.png)







#### XML：可扩展标记语言

- 由 WWW Consortium (W3C)定义
- 最初目的是作为一个文档标记语言不是一个数据库语言
- 能够指定新的标签，并创建嵌套的标签结构，使XML成为数据交换的一种很好的方式，而不仅仅是文件
- XML已经成为新一代的数据交换格式的基础
- 各种各样的工具，可用于分析、浏览和查询XML文档/数据

``` xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE book system "http://sidbrc.com/DTDS/book.dtd">
<book >
    <year>”1998” </year>
  	 <title>XML技术内幕</title>
    <author>
       <firstname>Natanya</firstname>
       <lastname>Pitts</lastname>
    </author>
    <price> $25</price>
</book>

```



## 数据库语言	

### 4.数据库语言

#### DML

- DML（Data  Manipulation Language）:操纵那些按照某种适当的数据模型组织起来的数据的语言
  - 查询
  - 更新（增、删、改）
- DML分类
  - **过程化** -用户指定需要什么数据以及如何获得这些数据
  - **声明式（非过程化） -用户指定需要什么数据，但不指明如何获得这些数据
- SQL是应用最广泛的DML

#### DDL

- DDL（Data Definition Language）:用于定义数据库模式以及其他特征的语言

  - ```sql
    create table instructor (                           
        ID         char(5),
        name       varchar(20),
        dept_name  varchar(20),
        salary     numeric(8,2))；
    
    ```

  - 数据库模式

  - 完整性约束

    - 实体完整性/主键(ID 用来确定唯一的instructor)
    - 参照完整性/外键(SQL 中的参照约束)
      - 如：每个 instructor 元组的dept_name 的值都必须在department 关系中出现
    - 用户定义的完整性
        - 多数是对字段值域的规范，比如成绩取0-100
    - 断言、授权
    
  - DDL编译器产生一系列存储在数据字典中的表，数据字典包含元数据 (元数据是关于数据的数据)

### 5.关系数据库

#### SQL

- **SQL:广泛使用的非过程化语言**

- **SQL-DML**

  - 示例: 查找物理系教师的ID和物理系所在地

  ````sql
  select instructor.ID, department.building
  from instructor, department
  where instructor.dept_name = department.dept_name and       department.dept_name = ‘Physics’;
  ````

- **SQL-DDL**

  - 示例: 定义dept表	

  ```sql
  create table deptment
         (dept_name char(20),
          building char(15),
           budget numberic(12,2)
          );
  
  ```

- 来自应用程序的数据库访问

  - DML由宿主语言执行

### 数据库设计

- 数据库设计的主要内容是数据库模式的设计
- 数据库设计过程
  - 用户需求获取
  - 概念设计
  - 逻辑设计
  - 物理设计

![17](.\图片\17.png)

- 现实世界是实体及其实体之间联系的集合

  - 实体：现实世界中区别于其他对象的“事情”或者“物体”
    - 实体被一组属性所描述
  - 联系：几个实体之间的关联

- 可以用实体-联系图（entity-relationship diagram，E-R图）来表示

- ![18](.\图片\18.png)

- **规范化：数据库设计的另外一种方法，目标是生成一个关系模式集合，使我们存储信息是没有不必要的冗余，同时又能方便地检索数据**

  规范化最常用的方法是使用***函数依赖***

  规范化也提供了判定一个关系模式优劣的标准

### 数据存储和查询

-  存储管理器是一个程序模块，提供了数据库中存储的低层数据与应用程序以及向系统提交的查询之间的接口

- 存储管理器的任务: 

  - 与文件管理器交互
  - 对数据的有效的存储、查询和更新

- 存储管理器部件

  - 权限及完整性管理器
  - 事务管理器
  - 文件管理器
  - 缓冲区管理器

- 查询处理器组件包括

  - DDL解释器：它解释DDL语句，并将这些定义记录在数据字典中

  - DML编译器：将查询语言中的DML语句翻译成为一个执行方案

  - 查询执行引擎：执行由DML编译器产生的低级指令

    ![19](.\图片\19.png)
  
 - 查询处理器工作过程
    1.	解析和转换
    2.	优化
    3. 计算
    
 - 两方面来评估一个给定的查询

    -  等价表达式
    -  每个操作有不同的实现算法

 - 一个好的查询和一个坏的查询评估的代价可能是巨大的

 - 需要估计操作的开销

    -  关键取决于数据库需要维护的关系的统计信息
    -  需要估计中间结果的统计数据，从而计算复杂的表达式成本


## 事务管理

### 8.事务管理

- 如果系统出现故障?

- 如果多个用户同时更新相同的数据?

- **事务是由一系列操作序列构成的程序执行单元，是一个不可分割的工作单位**

- 事务特性(ACID)
  - 原子性(Atomicity)
    - 事务中包含的所有操作要么全做，要么全不做
    - 原子性由恢复机制实现
  - 一致性(Consistency)
    - 事务的隔离执行必须保证数据库的一致性
    - 事务开始前，数据库处于一致性的状态；事务结束后，数据库必须仍处于一致性状态
    - 数据库的一致性状态由用户来负责，由并发控制机制实现
    - 如银行转帐，转帐前后两个帐户金额之和应保持不变
    - 事务运行过程中允许暂时的不一致
  - 隔离性(Isolation)
    - 系统必须保证事务不受其它并发执行事务的影响
    - 对任何一对事务T1，T2，在T1看来，T2要么在T1开始之前已经结束，要么在T1完成之后再开始执行
    - 隔离性通过并发控制机制实现
  - 持久性(Durability)
    - 一个事务一旦提交之后，它对数据库的影响必须是永久的
    - 系统发生故障不能改变事务的持久性
    - 持久性通过恢复机制实现
  
### 1.9数据库系统内部

#### DBMS运行过程

- Step 1
    - 用户向DBMS发出调用数据库数据的命令

- Step 2
    - DBMS对命令进行语法检查、语义检查、存取权限检查，决定是否执行该命令

- Step 3
    - DBMS执行查询优化，把命令转换为一串单记录的存取操作序列

- Step 4
    - 执行存取操作序列（反复执行以下各步，直至结束）

- Step 5
    - DBMS首先在缓冲区内查找记录，若找到转10，否则转6

- Step 6
    - DBMS查看存储模式，决定从哪个文件存取哪个物理记录

- Step 7
    DBMS根据6的结果，向操作系统发出读取记录的命令
- Step 8
    - 操作系统执行读取数据的命令

- Step 9
    - 操作系统将数据从数据库存储区送到系统缓冲区

- Step 10
    - DBMS根据用户命令和数据字典的内容导出用户所要读取的数据格式

- Step 11
    - DBMS将数据记录从系统缓冲区传送到用户工作区

- Step 12
    - DBMS将执行状态信息返回给用户


![20](.\图片\20.png)

### 10.数据库系统体系结构

- 数据库系统的体系结构很大程度上取决于数据库系统所运行的计算机系统
  - 集中式
  - 客户/服务器式
    - 远程数据库用户工作用的客户机（client）
    - 运行数据库系统的服务器(server)
  - 浏览器/服务器
  - 并行 (多处理器)
    - 并行系统通过并行地使用多个处理器和磁盘来提高处理速度和I/O速度
  - 分布式 
    - 在分布式数据库系统中，数据库存储在几台计算机中，分布式系统中的计算机之间通过网络相互通信，它们不共享主存储器或者磁盘

![21](.\图片\21.png)

### 11.数据挖掘与分析

- 数据挖掘
  - 数据挖掘就是应用一系列技术从大型数据库或数据仓库中提取人们感兴趣的信息和知识，这些知识或信息是隐含的，事先未知而潜在有用的，提取的知识表示为概念、规则、规律、模式等形式
  - 数据挖掘是一类深层次的数据分析
  - 数据仓库--OLAP
  - 关联规则挖掘
  - 。。。
- 信息检索
- 大数据分析

### 12.数据库用户和管理员

- 对数据库系统进行集中控制的人称作数据库管理员（DataBase  Administrator）
- DBA的作用
  - 模式定义
  - 存储结构及存取方法定义
  - 模式及物理组织的修改
  - 数据访问授权
  - 日常维护

### 13 数据库系统的历史

- 20世纪80年代:
  - 研究用关系原型演化为商用系统
    - SQL 成为产业界标准
  - 并行和分布式数据库系统
  - 面向对象数据库系统
- 20世纪90年代:
  - 大型决策支持和数据挖掘应用
  - 大型 multi-terabyte 数据仓库
  - Web 商务应用出现
- Early 2000s:
  - XML 和 XQuery 标准
  - 数据库自管理
- Later 2000s:
    - NoSQL
    - NewSQL


## 数据库用户

## 数据库系统总体结构



# 问题

### 第一章

#### 1.1

问题1：你还知道哪些领域要用到数据库系统呢？（PPT第4页）
问题2：对于李明这个学生记录，你能给出其他的合理解释吗？（PPT第8页）
问题3：由同城的供应商供应红色零件的所有工程，在文件系统阶段，程序处理流程是什么？（PPT第27页--可以提前在纸上画画流程图）
问题4：文件系统阶段的应用和数据库系统阶段比较  运行效率？开发效率？（PPT第35页）

#### 1.2

问题1：举一个物理数据独立性的例子
问题2：ER和OO，都属于概念模型，他们跟关系、网状和层次模型有什么不同？
问题3：什么工具可用于分析、浏览和查询XML（可以上网搜一下）

#### 1.3

问题1：P8的教师表的设计有什么问题？
问题2：自学17-20页
问题3：给定一个sql，试述它的执行流程是什么。

```sql
Select name
From instructor
Where salary >80000
```

![22](.\图片\22.png)
